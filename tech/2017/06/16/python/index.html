<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.25" />


<title>《廖雪峰 Python 教程》笔记 3：Module, Package - 彭浩 ~ Hao Peng</title>
<meta property="og:title" content="《廖雪峰 Python 教程》笔记 3：Module, Package - 彭浩 ~ Hao Peng">



  








<link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">

<link rel="stylesheet" href="/css/custom.css">

<link rel="stylesheet" href="/css/localsearch.css">

<link rel="stylesheet" href="/lib/lightGallery/css/lightgallery.css">

<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script async src="/js/load-typekit.js"></script>



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo.png"
         width="50"
         height="50"
         alt="Hao Peng">
  </a>

  <ul class="nav-links">
    
	
	
    
	

	
    
    <li class=""><a href="/">首页</a></li>
    
    <li class=""><a href="/tech/">归档</a></li>
    
    <li class=""><a href="/tech/categories/">分类</a></li>
    
    <li class=""><a href="/tech/tags/">标签</a></li>
    
    <li class=""><a href="javascript:;" class="popup-trigger"><i class="fa fa-search" aria-hidden="true" title="搜索"></i></a></li>
    
  </ul>
</nav>


<div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>
      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">3329 字</span>
    

    
<h1 class="article-title">《廖雪峰 Python 教程》笔记 3：Module, Package


</h1>



<div class="article-date">
  <span> 2017/06/16</span>
  <span class="article-toolbar">
    
    <a href="/tech/index.xml" type="application/rss+xml" target="_blank"><i class="fa fa-rss" aria-hidden="true" title="RSS feed"></i></a>
    
    <a href="https://twitter.com/home?status=%E3%80%8A%E5%BB%96%E9%9B%AA%E5%B3%B0&#43;Python&#43;%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0&#43;3%EF%BC%9AModule%2C&#43;Package&#43;%2Ftech%2F2017%2F06%2F16%2Fpython%2F&#43;via&#43;%40haopeng" target="_blank"><i class="fa fa-twitter" aria-hidden="true" title="Share via Twitter"></i></a>
    <a href="http://service.weibo.com/share/share.php?content=utf-8&amp;title=%E3%80%8A%E5%BB%96%E9%9B%AA%E5%B3%B0&#43;Python&#43;%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%94%E8%AE%B0&#43;3%EF%BC%9AModule%2C&#43;Package&#43;%40%E5%BD%AD%E6%B5%A9&amp;url=%2Ftech%2F2017%2F06%2F16%2Fpython%2F" target="_blank"><i class="fa fa-weibo" aria-hidden="true" title="分享到新浪微博"></i></a>
    <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fa fa-cc" aria-hidden="true" title="Attribution-NonCommercial-ShareAlike 4.0 International"></i></a>
    
	
    
	
    <a href="https://github.com/haopen/Blogdown/edit/master/content/tech/2017-06-16-Python.md"><i class="fa fa-pencil-square-o" aria-hidden="true" title="编辑本页"></i></a>
    
    </span>
</div>

<div class="article-taxonomies">
  
  <span class="category-prefix"><i class="fa fa-folder-o"></i></span>
  
  <span class="taxonomy-category"><a href="/categories/4-python" title="Python">Python</a></span>;
  
  
  
  <span class="tag-prefix"><i class="fa fa-tags"></i></span>
  
  <span class="taxonomy-tag"><a href="/tags/4-python" title="Python">Python</a></span>;
  
  
</div>


    
    <div class="article-content cn" id="articleContent">
      

<p><strong>原文地址</strong>：</p>

<p><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014318447437605e90206e261744c08630a836851f5183000" target="_blank">http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014318447437605e90206e261744c08630a836851f5183000</a></p>

<h1 id="概念">概念</h1>

<h2 id="模块">模块</h2>

<p>在计算机程序的开发过程中，随着程序代码越写越多，在一个文件里代码就会越来越长，越来越不容易维护。为了编写可维护的代码，我们把很多函数分组，分别放到不同的文件里，这样，每个文件包含的代码就相对较少，很多编程语言都采用这种组织代码的方式。在 Python 中，一个<code>.py</code>文件就称之为一个<strong>模块</strong>（Module）。</p>

<!-- more -->

<p>使用模块有什么好处？</p>

<p>最大的好处是大大提高了代码的可维护性。其次，编写代码不必从零开始。当一个模块编写完毕，就可以被其他地方引用。我们在编写程序的时候，也经常引用其他模块，包括 Python 内置的模块和来自第三方的模块。</p>

<p>使用模块还可以避免函数名和变量名冲突。相同名字的函数和变量完全可以分别存在不同的模块中，因此，我们自己在编写模块时，不必考虑名字会与其他模块冲突。但是也要注意，尽量不要与内置函数名字冲突。点<a href="http://docs.python.org/3/library/functions.html" target="_blank">这里</a>查看 Python 的所有内置函数。</p>

<h2 id="包">包</h2>

<p>你也许还想到，如果不同的人编写的模块名相同怎么办？为了避免模块名冲突，Python 又引入了按目录来组织模块的方法，称为<strong>包</strong>（Package）。</p>

<p>举个例子，一个<code>abc.py</code>的文件就是一个名字叫<code>abc</code>的模块，一个<code>xyz.py</code>的文件就是一个名字叫<code>xyz</code>的模块。</p>

<p>现在，假设我们的<code>abc</code>和<code>xyz</code>这两个模块名字与其他模块冲突了，于是我们可以通过包来组织模块，避免冲突。方法是选择一个顶层包名，比如<code>mycompany</code>，按照如下目录存放：</p>

<pre><code>+ mycompany
    - __init__.py
    - abc.py
    - xyz.py
</code></pre>

<p>引入了包以后，只要顶层的包名不与别人冲突，那所有模块都不会与别人冲突。现在，<code>abc.py</code>模块的名字就变成了<code>mycompany.abc</code>，类似的，<code>xyz.py</code>的模块名变成了<code>mycompany.xyz</code>。</p>

<p>请注意，每一个包目录下面都会有一个<code>__init__.py</code>的文件，这个文件是必须存在的，否则，Python 就把这个目录当成普通目录，而不是一个包。<code>__init__.py</code>可以是空文件，也可以有 Python 代码，因为<code>__init__.py</code>本身就是一个模块，而它的模块名就是<code>mycompany</code>。</p>

<p>类似的，可以有多级目录，组成多级层次的包结构。比如如下的目录结构：</p>

<pre><code>+ mycompany
    + web
        - __init__.py
        - utils.py
        - www.py
    - __init__.py
    - abc.py
    - utils.py
    - xyz.py
</code></pre>

<p>文件<code>www.py</code>的模块名就是<code>mycompany.web.www</code>，两个文件<code>utils.py</code>的模块名分别是<code>mycompany.utils</code>和<code>mycompany.web.utils</code>。</p>

<p>自己创建模块时要注意命名，不能和 Python 自带的模块名称冲突。例如，系统自带了<code>sys</code>模块，自己的模块就不可命名为<code>sys.py</code>，否则将无法导入系统自带的<code>sys</code>模块。</p>

<p><code>mycompany.web</code>也是一个模块，请指出该模块对应的<code>.py</code>文件。</p>

<h1 id="使用模块-完整示例">使用模块：完整示例</h1>

<p>Python 本身就内置了很多非常有用的模块，只要安装完毕，这些模块就可以立刻使用。</p>

<p>我们以内建的<code>sys</code>模块为例，编写一个<code>hello</code>的模块：</p>

<pre><code class="language-python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-

' a test module '

__author__ = 'Michael Liao'

import sys

def test():
    args = sys.argv
    if len(args)==1:
        print('Hello, world!')
    elif len(args)==2:
        print('Hello, %s!' % args[1])
    else:
        print('Too many arguments!')

if __name__=='__main__':
    test()
</code></pre>

<ul>
<li>第 1 行和第 2 行是标准注释，第 1 行注释可以让这个<code>hello.py</code>文件直接在<code>Unix/Linux/Mac</code>上运行，第 2 行注释表示<code>.py</code>文件本身使用标准 UTF-8 编码；</li>
<li>第 4 行是一个字符串，表示模块的文档注释，任何模块代码的第一个字符串都被视为模块的文档注释；</li>
<li>第 6 行使用<code>__author__</code>变量把作者写进去，这样当你公开源代码后别人就可以瞻仰你的大名；</li>
</ul>

<p>以上就是 Python 模块的标准文件模板，当然也可以全部删掉不写，但是，按标准办事肯定没错。后面开始就是真正的代码部分。</p>

<p>你可能注意到了，使用<code>sys</code>模块的第一步，就是导入该模块：</p>

<pre><code class="language-python">import sys
</code></pre>

<p>导入<code>sys</code>模块后，我们就有了变量<code>sys</code>指向该模块，利用<code>sys</code>这个变量，就可以访问<code>sys</code>模块的所有功能。</p>

<p><code>sys</code>模块有一个<code>argv</code>变量，用<code>list</code>存储了命令行的所有参数。<code>argv</code>至少有一个元素，因为第一个参数永远是该<code>.py</code>文件的名称，例如：</p>

<ul>
<li>运行<code>python3 hello.py</code>获得的<code>sys.argv</code>就是<code>['hello.py']</code>；</li>
<li>运行<code>python3 hello.py Michael</code>获得的<code>sys.argv</code>就是<code>['hello.py', 'Michael]</code>。</li>
</ul>

<p>最后，注意到这两行代码：</p>

<pre><code class="language-python">if __name__=='__main__':
    test()
</code></pre>

<p>当我们在命令行运行<code>hello</code>模块文件时，Python 解释器把一个特殊变量<code>__name__</code>置为<code>__main__</code>，而如果在其他地方导入该<code>hello</code>模块时，<code>if</code>判断将失败，因此，这种<code>if</code>测试可以让一个模块通过命令行运行时执行一些额外的代码，最常见的就是运行测试。</p>

<p>我们可以用命令行运行<code>hello.py</code>看看效果：</p>

<pre><code class="language-python">$ python3 hello.py
Hello, world!
$ python hello.py Michael
Hello, Michael!
</code></pre>

<p>如果启动Python交互环境，再导入hello模块：</p>

<pre><code class="language-python">$ python3
Python 3.4.3 (v3.4.3:9b73f1c3e601, Feb 23 2015, 02:52:03) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import hello
&gt;&gt;&gt;
</code></pre>

<p>导入时，没有打印<code>Hello, word!</code>，因为没有执行<code>test()</code>函数。</p>

<p>调用<code>hello.test()</code>时，才能打印出<code>Hello, word!</code>：</p>

<pre><code class="language-python">&gt;&gt;&gt; hello.test()
Hello, world!
</code></pre>

<h2 id="作用域">作用域</h2>

<p>在一个模块中，我们可能会定义很多函数和变量，但有的函数和变量我们希望给别人使用，有的函数和变量我们希望仅仅在模块内部使用。在 Python 中，是通过<code>_</code>前缀来实现的。</p>

<ul>
<li>正常的函数和变量名是<strong>公开</strong>的（public），可以被直接引用，比如：<code>abc</code>，<code>x123</code>，<code>PI</code>等；</li>
<li>类似<code>__xxx__</code>这样的变量是<strong>特殊</strong>变量，可以被直接引用，但是有特殊用途，比如上面的<code>__author__</code>，<code>__name__</code>就是特殊变量，<code>hello</code>模块定义的文档注释也可以用特殊变量<code>__doc__</code>访问，我们自己的变量一般不要用这种变量名；</li>
<li>类似<code>_xxx</code>和<code>__xxx</code>这样的函数或变量就是<strong>非公开</strong>的（private），不应该被直接引用，比如<code>_abc</code>，<code>__abc</code>等；</li>
</ul>

<p>之所以我们说，private 函数和变量<strong>不应该</strong>被直接引用，而不是<del><strong>不能</strong></del>被直接引用，是因为 Python 并没有一种方法可以完全限制访问 private 函数或变量，但是，从编程习惯上不应该引用 private 函数或变量。</p>

<p>private 函数或变量不应该被别人引用，那它们有什么用呢？请看例子：</p>

<pre><code class="language-python">def _private_1(name):
    return 'Hello, %s' % name

def _private_2(name):
    return 'Hi, %s' % name

def greeting(name):
    if len(name) &gt; 3:
        return _private_1(name)
    else:
        return _private_2(name)
</code></pre>

<p>我们在模块里公开<code>greeting()</code>函数，而把内部逻辑用 private 函数隐藏起来了，这样，调用<code>greeting()</code>函数不用关心内部的 private 函数细节，这也是一种非常有用的代码封装和抽象的方法，即：</p>

<p>外部不需要引用的函数全部定义成 private，只有外部需要引用的函数才定义为 public。</p>

<h1 id="第三方模块">第三方模块</h1>

<p>在 Python 中，安装第三方模块，是通过包管理工具<code>pip</code>完成的。</p>

<ul>
<li>如果你正在使用 Mac 或 Linux，安装<code>pip</code>本身这个步骤就可以跳过了。</li>
<li>如果你正在使用 Windows，请参考<a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014316090478912dab2a3a9e8f4ed49d28854b292f85bb000" target="_blank">安装 Python</a> 一节的内容，确保安装时勾选了<code>pip</code>和<code>Add python.exe to Path</code>。</li>
</ul>

<p>在命令提示符窗口下尝试运行<code>pip</code>，如果 Windows 提示未找到命令，可以重新运行安装程序添加<code>pip</code>。</p>

<blockquote>
<p><strong>注意</strong>：Mac 或 Linux 上有可能并存 Python 3.x 和 Python 2.x，因此对应的 pip 命令是<code>pip3</code>。</p>
</blockquote>

<p>现在，让我们来安装一个第三方库——<strong>Python Imaging Library</strong>，这是 Python 下非常强大的处理图像的工具库。不过，<code>PIL</code>目前只支持到 Python 2.7，并且有年头没有更新了，因此，基于<code>PIL</code>的<code>Pillow</code>项目开发非常活跃，并且支持最新的 Python 3。</p>

<p>一般来说，第三方库都会在 Python 官方的 <pypi.python.org> 网站注册，要安装一个第三方库，必须先知道该库的名称，可以在官网或者pypi上搜索，比如 <a href="https://pypi.python.org/pypi/Pillow/" target="_blank">Pillow</a> 的名称叫<code>Pillow</code>，因此，安装<code>Pillow</code>的命令就是：</p>

<pre><code class="language-bash">pip install Pillow
</code></pre>

<p>耐心等待下载并安装后，就可以使用<code>Pillow</code>了。</p>

<p>有了<code>Pillow</code>，处理图片易如反掌。随便找个图片生成缩略图：</p>

<pre><code class="language-python">&gt;&gt;&gt; from PIL import Image
&gt;&gt;&gt; im = Image.open('test.png')
&gt;&gt;&gt; print(im.format, im.size, im.mode)
PNG (400, 300) RGB
&gt;&gt;&gt; im.thumbnail((200, 100))
&gt;&gt;&gt; im.save('thumb.jpg', 'JPEG')
</code></pre>

<p>其他常用的第三方库还有 MySQL 的驱动：<code>mysql-connector-python</code>，用于科学计算的 NumPy 库：<code>numpy</code>，用于生成文本的模板工具<code>Jinja2</code>，等等。</p>

<h2 id="模块搜索路径">模块搜索路径</h2>

<p>当我们试图加载一个模块时，Python 会在指定的路径下搜索对应的<code>.py</code>文件，如果找不到，就会报错：</p>

<pre><code class="language-python">&gt;&gt;&gt; import mymodule
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
ImportError: No module named mymodule
</code></pre>

<p>默认情况下，Python 解释器会搜索当前目录、所有已安装的内置模块和第三方模块，搜索路径存放在<code>sys</code>模块的<code>path</code>变量中：</p>

<pre><code class="language-python">&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.path
['', '/Library/Frameworks/Python.framework/Versions/3.4/lib/python34.zip', '/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4', '/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/plat-darwin', '/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/lib-dynload', '/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/site-packages']
</code></pre>

<p>如果我们要添加自己的搜索目录，有两种方法：</p>

<ol>
<li>直接修改<code>sys.path</code>，添加要搜索的目录：</li>
</ol>

<pre><code class="language-python">&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.path.append('/Users/michael/my_py_scripts')
</code></pre>

<p>这种方法是在运行时修改，运行结束后失效。</p>

<ol>
<li>设置环境变量<code>PYTHONPATH</code>，该环境变量的内容会被自动添加到模块搜索路径中。设置方式与设置<code>Path</code>环境变量类似。注意只需要添加你自己的搜索路径，Python 自己本身的搜索路径不受影响。</li>
</ol>

    </div>
    

<nav id="article-nav">
    
    <a href="/tech/2017/06/15/rmarkdown-notes/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> RMarkdown 应用笔记</div>
    </a>
    

    
    <a href="/tech/2017/06/17/python-class/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title">《廖雪峰 Python 教程》笔记 4：面向对象编程1 <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></div>
    </a>
    
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/tech\/2017\/06\/15\/rmarkdown-notes\/';
    
  } else if (e.which == 39) {  
    
    url = '\/tech\/2017\/06\/17\/python-class\/';
    
  }
  if (url) window.location = url;
});
</script>



  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script src="/js/disqusloader.min.js"></script>
  <script>
  var disqus_config = function () {
  
    this.page.url = "https:\/\/haopen.github.io\/" + location.pathname;
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = 'https://haopeng.disqus.com/embed.js';
    
    if (location.hash.match(/^#comment/)) {
      var d = document, s = d.createElement('script');
      s.src = disqus_js; s.async = true;
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    } else {
      disqusLoader('#disqus_thread', {
        scriptUrl: disqus_js, laziness: 0, disqusConfig: disqus_config
      });
    }
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          
          
          <li><a href="https://github.com/haopen"><i class="fa fa-github" aria-hidden="true" title="Github"></i><span class="sr-only">Github</span></a></li>
          <li><a href="https://twitter.com/haopeng"><i class="fa fa-twitter" aria-hidden="true" title="Twitter"></i><span class="sr-only">Twitter</span></a></li>
          <li><a href="http://weibo.com/seplost"><i class="fa fa-weibo" aria-hidden="true" title="新浪微博"></i><span class="sr-only">新浪微博</span></a></li>
          
          <li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fa fa-cc" aria-hidden="true" title="Attribution-NonCommercial-ShareAlike 4.0 International"></i><span class="sr-only">Attribution-NonCommercial-ShareAlike 4.0 International</span></a></li>
          <li><a href="/"><i class="fa fa-copyright" aria-hidden="true" title="Copyright"></i> 2005 - 2017</a></li>
        </ul>
      </footer>
    </div>

	<div id="images-container"></div>

    <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="/lib/jquery/jquery.mousewheel.min.js"></script>
	<script type="text/javascript" src="/lib/lightGallery/js/lightgallery.min.js"></script>
	<script type="text/javascript" src="/lib/lightGallery/js/lg-thumbnail.min.js"></script>
	<script type="text/javascript" src="/lib/lightGallery/js/lg-fullscreen.min.js"></script>
	<script type="text/javascript" src="/lib/lightGallery/js/lg-zoom.min.js"></script>
	<script type="text/javascript" src="/js/lgGallery_Prepare.js"></script>
	<script type="text/javascript" src="/js/load-pangu.js"></script>
    
    <script async src="/js/center-img.js"></script>
    
    <script async src="/js/right-quote.js"></script>
    
    <script async src="/js/no-highlight.js"></script>
    
    <script async src="/js/fix-footnote.js"></script>
    
    <script async src="/js/local-search.js"></script>
    
    



<script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/tex.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/matlab.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
	TeX: {equationNumbers: {autoNumber: ["AMS"], useLabelIds: true}},
	"HTML-CSS": {linebreaks: {automatic: true}},
	SVG: {linebreaks: {automatic: true}}
});
</script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

